# Chapter 9: Nav2 - Path Planning for Bipedal Humanoid Movement — Lesson Plan

**Generated by**: chapter-planner v2.0.0 (Reasoning-Activated)
**Source Spec**: specs/book/part-3-spec.md
**Created**: 2025-12-17
**Constitution**: v6.0.1 (Reasoning Mode)

---

## I. Chapter Analysis

### Chapter Type
**Technical/Code-Focused** — Nav2 navigation stack configuration and bipedal adaptation. Chapter teaches implementation skills (Nav2 installation, costmap configuration, path planner selection, behavior tree design, parameter tuning). Learning objectives emphasize "configure," "implement," "tune," "integrate" (action verbs indicating hands-on technical work). Code examples (YAML configs, launch files, behavior trees) and practical tuning exercises required throughout.

### Concept Density Analysis

**Core Concepts** (from spec): 10 major concepts
1. Nav2 architecture (navigation stack components)
2. Costmaps (local, global, inflation layers)
3. Path planners (Navfn, Smac, TEB for bipedal)
4. Controller plugins (DWB, Regulated Pure Pursuit)
5. Behavior trees (navigation logic, recovery behaviors)
6. Bipedal constraints (stability, center of mass, step planning)
7. Footstep planning (discrete foot placement vs continuous control)
8. Dynamic obstacle avoidance (real-time replanning)
9. Nav2 parameters (tuning for humanoid vs wheeled robot)
10. Integration: VSLAM (Chapter 8) → Nav2 (Chapter 9)

**Complexity Assessment**: **Complex** — 10 concepts, high complexity. Nav2 is a sophisticated navigation stack with many components (costmaps, planners, controllers, behavior trees). Adapting Nav2 for bipedal humanoids requires understanding stability constraints not present in wheeled robots. Integration with VSLAM (Chapter 8) adds localization dependency. Prerequisites from Part 1-2 (ROS 2, sensors) and Part 3 Ch7-8 (Isaac Sim, VSLAM) provide foundation, but bipedal navigation is new paradigm.

**Proficiency Tier**: B2-C1 (Intermediate Application to Advanced Integration) from chapter-index.md
- B2: Can configure Nav2 with guidance
- C1: Can tune parameters and design behavior trees independently

**Justified Lesson Count**: 9 lessons
- Layer 1 (Manual): 2 lessons (Nav2 architecture, costmaps)
- Layer 2 (AI Collaboration): 4 lessons (planners, controllers, behavior trees, dynamic obstacles)
- Layer 3 (Intelligence Design): 2 lessons (nav2-humanoid-config skill, behavior-tree-design skill)
- Layer 4 (Capstone): 1 lesson (autonomous humanoid navigation)
- **Total**: 9 lessons

**Reasoning**: High concept density (10 concepts) at B2-C1 proficiency justifies 9 lessons. Complex Nav2 stack requires solid Layer 1 foundation (2 lessons on architecture + costmaps). Bipedal adaptation is multi-faceted (4 Layer 2 lessons: planners, controllers, behavior trees, obstacles). Two Layer 3 lessons encode humanoid-specific configuration patterns and behavior tree design patterns. Capstone integrates VSLAM (Chapter 8) + Nav2 for full autonomous navigation.

---

## II. Success Criteria (from Part 3 Spec)

### Technical Success Evals
- **Eval-9.1**: Students configure Nav2 stack for humanoid robot
- **Eval-9.2**: Students create costmaps with humanoid-specific inflation radius
- **Eval-9.3**: Students select appropriate path planner for bipedal gait
- **Eval-9.4**: Students implement behavior tree for navigation + recovery
- **Eval-9.5**: Students tune Nav2 parameters collaboratively with AI
- **Eval-9.6**: Students integrate VSLAM (Chapter 8) as Nav2 localization source
- **Eval-9.7**: Students handle dynamic obstacles (real-time replanning)

### Pedagogical Success
- [ ] All lessons follow 4-layer teaching framework
- [ ] Collaborative parameter tuning pattern (student + AI iterate on config)
- [ ] Behavior tree design using specification-first approach
- [ ] "Try With AI" sections demonstrate AI collaboration (no meta-commentary)
- [ ] Exercises have checkbox success criteria
- [ ] Capstone integrates all 3 Part 3 chapters (Isaac Sim + VSLAM + Nav2)

---

## III. Lesson Sequence

### Lesson 1: Nav2 Architecture and Component Overview (Layer 1: Manual Foundation)

**Learning Objective**: Understand Nav2 navigation stack architecture (costmaps, planners, controllers, behavior trees, recovery) by manually examining configuration files and component relationships.

**Stage**: 1 (Manual Foundation)

**CEFR Proficiency**: B2

**New Concepts** (count: 7 — within B2 limit of 7-10):
1. Nav2 architecture (modular plugin system)
2. Navigation server (action server interface)
3. Planner plugins (global path planning)
4. Controller plugins (local trajectory tracking)
5. Behavior tree executor (navigation logic)
6. Recovery behaviors (stuck detection and resolution)
7. Nav2 lifecycle management (ROS 2 lifecycle nodes)

**Cognitive Load Validation**: 7 concepts ≤ 10 limit (B2) → ✅ WITHIN LIMIT

**Maps to Evals**: Eval-9.1 (foundational for Nav2 configuration)

**Content Elements**:
- **Nav2 motivation**: Why navigation stack? (autonomous movement in unknown/changing environments)
- **Manual architecture exploration**: Students examine Nav2 directory structure, identify configuration files
- **Component relationship diagram**: Visual flowchart (costmaps → planner → controller → robot, behavior tree orchestrates)
- **Configuration file walkthrough**: Students manually read YAML configs, understand parameters (no modification yet)
- **No AI assistance yet**: Build mental model of Nav2 ecosystem before configuration
- **Practice**: Students install Nav2 packages, launch sample navigation (TurtleBot3 example)
- **Checkpoint**: Students explain in own words: "What does planner do? What does controller do? How does behavior tree coordinate them?"

**Prerequisites**: Part 1 (ROS 2 actions, lifecycle nodes), Part 3 Ch7 (Isaac Sim), Ch8 (VSLAM)

**Estimated Time**: 90 minutes

**Teaching Pattern**: Collaborative parameter tuning setup (establish baseline before AI collaboration)

---

### Lesson 2: Costmap Configuration for Humanoid Footprint (Layer 1: Manual Foundation)

**Learning Objective**: Configure global and local costmaps with humanoid-specific footprint, inflation radius, and sensor layers by manually editing configuration files and understanding layer composition.

**Stage**: 1 (Manual Foundation)

**CEFR Proficiency**: B2

**New Concepts** (count: 8 — within B2 limit of 7-10):
1. Costmap layers (static, obstacles, inflation, voxel)
2. Global vs local costmap (static map vs sensor-based)
3. Footprint specification (robot shape: rectangular, circular, polygon)
4. Inflation layer (obstacle expansion for safety margin)
5. Obstacle layer (sensor data integration: LiDAR, depth camera)
6. Static layer (pre-built map from SLAM)
7. Update frequency (global vs local rates)
8. Costmap coordinate frames (map, odom, base_link)

**Cognitive Load Validation**: 8 concepts ≤ 10 limit (B2) → ✅ WITHIN LIMIT

**Maps to Evals**: Eval-9.2 (create humanoid-specific costmaps)

**Content Elements**:
- **Costmap theory**: Why layered costmaps? (separation of concerns: static map, dynamic obstacles, safety inflation)
- **Manual configuration**: Students edit costmap YAML, define humanoid footprint (rectangular approximation of bipedal stance)
- **Inflation tuning**: Students manually calculate inflation radius (sensor range + reaction time)
- **Sensor layer integration**: Students add Isaac Sim depth camera to obstacle layer
- **No AI yet**: Build understanding of costmap parameters manually
- **Practice**: Students visualize costmaps in RViz (global + local, inflation visible)
- **Validation checkpoint**: Costmap shows humanoid footprint, obstacles inflated correctly, updates from sensors

**Prerequisites**: Lesson 1 (Nav2 architecture), Part 3 Ch7-8 (Isaac Sim sensors, VSLAM map)

**Estimated Time**: 120 minutes

**Teaching Pattern**: Specification-first (define footprint safety requirements before configuration)

---

### Lesson 3: Path Planner Selection for Bipedal Gait (Layer 2: AI Collaboration)

**Learning Objective**: Select and configure appropriate path planner for bipedal humanoid (Navfn vs Smac vs TEB), understanding tradeoffs between speed, smoothness, and kinematic constraints using AI collaboration.

**Stage**: 2 (AI Collaboration with Three Roles)

**CEFR Proficiency**: B2-C1

**New Concepts** (count: 7 — within B2 limit):
1. Navfn planner (Dijkstra-based, fast, grid-based)
2. Smac planner (State lattice, kinematic constraints, smoother paths)
3. TEB planner (Trajectory optimization, dynamic constraints, bipedal-friendly)
4. Planner comparison criteria (computation time, path smoothness, kinematic feasibility)
5. Bipedal kinematic constraints (turning radius, lateral movement, step frequency)
6. Planner parameters (cost functions, optimization weights)
7. Planner switching (when to use which planner)

**Cognitive Load Validation**: 7 concepts ≤ 10 limit (B2) → ✅ WITHIN LIMIT

**Maps to Evals**: Eval-9.3 (select appropriate planner for bipedal)

**Three Roles Demonstrations** (REQUIRED):

1. **AI as Teacher**:
   - *Scenario*: Student uses Navfn (fast but grid-based), humanoid makes sharp 90° turns (unstable)
   - *AI teaches*: "Navfn doesn't consider kinematic constraints. For bipedal robots, TEB planner optimizes trajectories respecting turning radius and lateral movement limits. Here's the tradeoff: [explains speed vs kinematic feasibility]"
   - *Learning*: Student learns planner selection impacts stability for bipedal robots

2. **AI as Student**:
   - *Scenario*: AI suggests TEB with aggressive optimization (shortest path)
   - *Student teaches*: "Our humanoid prioritizes stability over speed. We need smooth, wide turns. Here's the constraint: [specifies minimum turning radius = 0.5m]"
   - *Adaptation*: AI configures TEB with conservative cost weights (favor smoothness over distance)

3. **AI as Co-Worker**:
   - *Scenario*: Student and AI iterate on planner parameters
   - *Iteration 1*: Student uses default TEB weights → paths too long (excessive smoothing)
   - *Iteration 2*: AI suggests reducing smoothing weight → paths too sharp
   - *Iteration 3*: Together identify balanced weights → smooth + efficient
   - *Convergence*: Collaboration tuned parameters for bipedal-appropriate paths

**Content Elements**:
- **Recap Layer 1**: Review costmaps from Lesson 2
- **Manual planner comparison**: Student runs Navfn, Smac, TEB on same scenario, observe path differences in RViz
- **AI collaboration**: Select and tune planner for bipedal constraints (show all three roles)
- **Practice exercise**: Students configure TEB planner with AI, test on complex indoor environment
- **Validation checkpoint**: Humanoid follows smooth path, no sharp turns, reaches goal

**Prerequisites**: Lessons 1-2 (Nav2 architecture, costmaps)

**Estimated Time**: 120 minutes

---

### Lesson 4: Controller Configuration for Humanoid Tracking (Layer 2: AI Collaboration)

**Learning Objective**: Configure controller plugin (DWB or Regulated Pure Pursuit) for humanoid trajectory tracking, tuning velocity limits and acceleration constraints using AI collaboration.

**Stage**: 2 (AI Collaboration with Three Roles)

**CEFR Proficiency**: B2-C1

**New Concepts** (count: 7 — within B2 limit):
1. Controller plugins (DWB, Regulated Pure Pursuit, TEB local planner)
2. DWB (Dynamic Window Approach for bipedal footstep constraints)
3. Velocity limits (linear, angular, considering stability)
4. Acceleration limits (smooth velocity changes for balance)
5. Trajectory tracking error (cross-track error, heading error)
6. Controller cost functions (goal distance, path alignment, obstacle clearance)
7. Simulation vs reality gap (sim-to-real transfer considerations)

**Cognitive Load Validation**: 7 concepts ≤ 10 limit (B2) → ✅ WITHIN LIMIT

**Maps to Evals**: Eval-9.5 (tune Nav2 parameters collaboratively)

**Three Roles Demonstrations** (REQUIRED):

1. **AI as Teacher**:
   - *Scenario*: Student sets max velocity to 1.0 m/s (typical wheeled robot speed), humanoid loses balance
   - *AI teaches*: "Bipedal stability limits maximum velocity. For humanoid walking, max linear velocity typically 0.3-0.5 m/s. Here's why: [explains center of mass stability]"
   - *Learning*: Student learns velocity limits are biomechanical constraints, not just performance preferences

2. **AI as Student**:
   - *Scenario*: AI suggests conservative velocity (0.1 m/s, very slow)
   - *Student teaches*: "We need reasonable navigation speed for practical tasks. Our humanoid can walk at 0.4 m/s stably. Here's the performance target: [specifies goal: 0.4 m/s linear, 0.5 rad/s angular]"
   - *Adaptation*: AI configures DWB with velocity limits matching humanoid capabilities

3. **AI as Co-Worker**:
   - *Scenario*: Student and AI iterate on acceleration limits
   - *Iteration 1*: Student uses high acceleration → humanoid jerks, unstable
   - *Iteration 2*: AI suggests very low acceleration → navigation too slow
   - *Iteration 3*: Together identify smooth acceleration profile → stable + responsive
   - *Convergence*: Collaboration balanced responsiveness and stability

**Content Elements**:
- **Recap Layer 1**: Review planner output from Lesson 3
- **Manual controller testing**: Student runs DWB with default params (will fail with instability)
- **AI collaboration**: Tune velocity/acceleration limits for bipedal stability (show all three roles)
- **Practice exercise**: Students configure controller with AI, test trajectory tracking on curved path
- **Validation checkpoint**: Humanoid tracks path smoothly, no balance loss, reasonable speed

**Prerequisites**: Lessons 1-3 (Nav2 architecture, costmaps, planner)

**Estimated Time**: 120 minutes

---

### Lesson 5: Behavior Tree Design for Navigation Logic (Layer 2: AI Collaboration)

**Learning Objective**: Design behavior tree for autonomous navigation with recovery behaviors (stuck detection, rotation recovery, backup) using AI collaboration and specification-first approach.

**Stage**: 2 (AI Collaboration with Three Roles)

**CEFR Proficiency**: C1

**New Concepts** (count: 8 — within C1 limit of 10-12):
1. Behavior tree fundamentals (sequences, fallbacks, decorators)
2. Navigation behavior tree (navigate → retry → recover → abort)
3. Stuck detection (progress monitoring, timeout)
4. Rotation recovery (clear costmap by rotating in place)
5. Backup recovery (reverse to escape local minima)
6. Recovery escalation (try gentle recovery before aggressive)
7. BehaviorTree.CPP syntax (Nav2's behavior tree library)
8. Behavior tree XML configuration (Nav2 BT format)

**Cognitive Load Validation**: 8 concepts ≤ 12 limit (C1) → ✅ WITHIN LIMIT

**Maps to Evals**: Eval-9.4 (implement behavior tree for navigation + recovery)

**Three Roles Demonstrations** (REQUIRED):

1. **AI as Teacher**:
   - *Scenario*: Student's behavior tree retries navigation infinitely when stuck (no escalation)
   - *AI teaches*: "Infinite retries waste time. Behavior trees should escalate: try navigation → rotate recovery → backup recovery → abort and replan. Here's the pattern: [shows escalation sequence]"
   - *Learning*: Student learns recovery behavior hierarchy (gentle → aggressive → abort)

2. **AI as Student**:
   - *Scenario*: AI suggests aggressive recovery immediately (backup on first failure)
   - *Student teaches*: "Our indoor environment has narrow doorways. Backup might collide with walls. Try gentle recovery first (rotate to clear costmap). Here's the constraint: [specifies doorway width]"
   - *Adaptation*: AI designs BT with rotation recovery before backup

3. **AI as Co-Worker**:
   - *Scenario*: Student and AI iterate on stuck detection timeout
   - *Iteration 1*: Student uses 5-second timeout → false positives (aborts too early)
   - *Iteration 2*: AI suggests 60-second timeout → too patient (wastes time when truly stuck)
   - *Iteration 3*: Together identify 15-second timeout with progress threshold → robust
   - *Convergence*: Collaboration tuned detection that distinguishes stuck vs slow progress

**Content Elements**:
- **Behavior tree theory**: Why behavior trees for navigation? (flexible logic, hierarchical composition)
- **Specification-first**: Students write BT requirements BEFORE XML (success conditions, failure handling, recovery escalation)
- **AI collaboration**: Design BT from spec (show all three roles)
- **Practice exercise**: Students implement BT in Nav2 XML format with AI, test stuck scenarios
- **Validation checkpoint**: BT detects stuck, applies recovery, reaches goal or aborts gracefully

**Prerequisites**: Lessons 1-4 (Nav2 components configured)

**Estimated Time**: 120 minutes

---

### Lesson 6: Dynamic Obstacle Avoidance and Replanning (Layer 2: AI Collaboration)

**Learning Objective**: Implement real-time obstacle avoidance and replanning when environment changes (humans walk by, doors close), tuning costmap update rates and planner frequencies with AI collaboration.

**Stage**: 2 (AI Collaboration with Three Roles)

**CEFR Proficiency**: C1

**New Concepts** (count: 7 — within C1 limit):
1. Dynamic obstacles (moving objects not in static map)
2. Costmap update frequency (sensor data integration rate)
3. Replanning triggers (costmap change, progress timeout)
4. Global vs local replanning (when to replan full path vs local adjustment)
5. Obstacle prediction (anticipating human movement)
6. Safe stop behavior (emergency braking when collision imminent)
7. Social navigation considerations (human-aware path planning)

**Cognitive Load Validation**: 7 concepts ≤ 12 limit (C1) → ✅ WITHIN LIMIT

**Maps to Evals**: Eval-9.7 (handle dynamic obstacles with replanning)

**Three Roles Demonstrations** (REQUIRED):

1. **AI as Teacher**:
   - *Scenario*: Student's humanoid collides with simulated human walking across path
   - *AI teaches*: "Your local costmap update rate is too slow (1 Hz). For dynamic obstacles, increase to 5 Hz minimum. Here's the tradeoff: [explains update frequency vs CPU cost]"
   - *Learning*: Student learns real-time obstacle avoidance requires fast sensor integration

2. **AI as Student**:
   - *Scenario*: AI suggests aggressive replanning (replan every 0.1 seconds)
   - *Student teaches*: "Excessive replanning causes path oscillation (robot jitters). We need stable paths. Here's the constraint: [specifies replan only if costmap change >threshold]"
   - *Adaptation*: AI configures event-driven replanning (trigger on significant costmap change, not time-based)

3. **AI as Co-Worker**:
   - *Scenario*: Student and AI iterate on safe stop distance
   - *Iteration 1*: Student uses small safety margin → near-collisions
   - *Iteration 2*: AI suggests large margin → robot stops too far away (overly conservative)
   - *Iteration 3*: Together identify velocity-dependent margin → safe + efficient
   - *Convergence*: Collaboration designed stopping distance that scales with robot speed

**Content Elements**:
- **Dynamic obstacle motivation**: Why replanning? (static maps don't capture moving objects)
- **Manual testing**: Student spawns moving obstacle in Isaac Sim (human avatar), observe Nav2 behavior
- **AI collaboration**: Tune update rates and replanning triggers (show all three roles)
- **Practice exercise**: Students implement dynamic avoidance with AI, test with multiple moving obstacles
- **Validation checkpoint**: Humanoid avoids moving human, replans path, reaches goal safely

**Prerequisites**: Lessons 1-5 (full Nav2 stack configured)

**Estimated Time**: 120 minutes

---

### Lesson 7: Creating Nav2 Humanoid Configuration Skill (Layer 3: Intelligence Design)

**Learning Objective**: Encode Nav2 humanoid-specific configuration patterns into reusable skill for future bipedal robot projects.

**Stage**: 3 (Intelligence Design)

**CEFR Proficiency**: C1

**Reusable Artifact Created**: **nav2-humanoid-config-skill**

**Maps to Evals**: Eval-9.1, Eval-9.2, Eval-9.3, Eval-9.5 (configuration patterns)

**Skill Design Framework** (Persona + Questions + Principles):

**Persona Definition**:
"Think like a robotics engineer configuring navigation for bipedal robot. Your goal is to adapt Nav2 parameters (designed for wheeled robots) to humanoid constraints: stability limits, footstep kinematics, center of mass dynamics."

**Question Structure**:
1. What's the humanoid footprint? (Width, length, polygon vs circular approximation)
2. What's the maximum stable velocity? (Linear, angular, considering gait stability)
3. What's the inflation radius? (Sensor range + reaction time + safety margin)
4. Which path planner suits bipedal kinematics? (Navfn vs Smac vs TEB)
5. What acceleration limits prevent instability? (Smooth velocity changes for balance)

**Principle Articulation**:
1. **Footprint = Humanoid Width + Safety Margin**: Measure actual stance width, add 10-20% margin
2. **Max Velocity = Gait Stability Limit**: For walking humanoid, typically 0.3-0.5 m/s linear, 0.5 rad/s angular
3. **Inflation = Sensor Range + Reaction Time**: If LiDAR range 10m, velocity 0.4 m/s, inflate by 1-2m
4. **Prefer Trajectory Optimization Planners**: TEB or Smac for smooth paths (Navfn too jagged for bipedal)
5. **Conservative Acceleration**: Limit linear accel to 0.5 m/s², angular to 0.5 rad/s²

**Content Elements**:
- **Review Lessons 2-6**: What Nav2 parameters did we tune for humanoid?
- **Pattern extraction**: What's reusable across different humanoid platforms?
- **Skill creation**: Students write skill using Persona + Questions + Principles template
- **Usage validation**: Test skill on different humanoid (taller/shorter, different gait)
- **Documentation**: Students document configuration checklist for humanoid Nav2

**Prerequisites**: Lessons 2-6 (Nav2 configuration experience)

**Estimated Time**: 90 minutes

---

### Lesson 8: Creating Behavior Tree Design Skill (Layer 3: Intelligence Design)

**Learning Objective**: Encode behavior tree design patterns into reusable skill for navigation logic and recovery behaviors.

**Stage**: 3 (Intelligence Design)

**CEFR Proficiency**: C1

**Reusable Artifact Created**: **behavior-tree-design-skill**

**Maps to Evals**: Eval-9.4 (behavior tree design patterns)

**Skill Design Framework** (Persona + Questions + Principles):

**Persona Definition**:
"Think like a behavior tree architect designing navigation logic for autonomous robots. Your goal is to create robust, maintainable behavior trees with clear success/failure conditions, recovery escalation, and graceful degradation."

**Question Structure**:
1. What recovery behaviors apply to this scenario? (Rotate, backup, replan, abort?)
2. What failure conditions trigger recovery? (Stuck detection: progress <threshold, timeout?)
3. How should recovery escalate? (Gentle recovery first, then aggressive, then abort?)
4. What are clear success/failure conditions? (How do we know when to stop retrying?)
5. How do I test the behavior tree? (What failure scenarios validate recovery logic?)

**Principle Articulation**:
1. **Hierarchical Composition**: Navigate → Recover → Retry → Abort (clear escalation path)
2. **Timeout-Based Recovery Triggers**: If no progress for T seconds → trigger recovery (T typically 10-20s)
3. **Recovery Escalation**: Try least invasive first (rotate) before aggressive (backup) before abort
4. **Clear Success/Failure Conditions**: Define measurable conditions (distance to goal <threshold = success)
5. **Test Failure Scenarios**: Intentionally create stuck situations to validate recovery logic

**Content Elements**:
- **Review Lesson 5**: What behavior tree patterns did we design?
- **Pattern extraction**: What's reusable for navigation + recovery logic?
- **Skill creation**: Students write skill using Persona + Questions + Principles template
- **Usage validation**: Test skill on different navigation scenario (outdoor, different obstacles)
- **Documentation**: Students document BT design checklist and testing methodology

**Prerequisites**: Lesson 5 (behavior tree design experience)

**Estimated Time**: 90 minutes

---

### Lesson 9: Capstone - Autonomous Humanoid Navigation (Layer 4: Spec-Driven Integration)

**Learning Objective**: Implement fully autonomous humanoid navigation integrating Isaac Sim (Chapter 7), VSLAM (Chapter 8), and Nav2 (Chapter 9) using specification-first approach, composing all accumulated skills.

**Stage**: 4 (Spec-Driven Integration / Capstone)

**CEFR Proficiency**: C1

**Maps to Evals**: ALL Part 3 evals integrated (Chapters 7-9)

**Project Specification** (Spec FIRST, then implementation):

**Intent**:
Implement autonomous humanoid navigation system. Humanoid must navigate indoor environment (Isaac Sim) using VSLAM for localization, Nav2 for path planning/control, avoiding dynamic obstacles (simulated humans), and recovering from stuck situations.

**Constraints**:
- **Localization**: Isaac Visual SLAM (Chapter 8) provides map and pose
- **Planning**: Nav2 stack (Chapter 9) plans paths and controls humanoid
- **Environment**: Isaac Sim indoor office (Chapter 7) with moving humans
- **Real-time**: Full pipeline runs ≥10 Hz (VSLAM 30 Hz, Nav2 10 Hz)
- **Safety**: No collisions with static or dynamic obstacles

**Success Criteria**:
- [ ] Humanoid navigates from Start to Goal (10m distance) autonomously
- [ ] Avoids static obstacles (walls, furniture) via costmap
- [ ] Avoids dynamic obstacles (walking humans) via replanning
- [ ] Recovers from stuck situations using behavior tree recovery
- [ ] Full integration: Isaac Sim → VSLAM → Nav2 → Humanoid Control
- [ ] Real-time performance: Pipeline runs without frame drops

**Component Composition**:
- **Chapter 7 Skills**: isaac-sim-performance (optimize rendering for real-time)
- **Chapter 8 Skills**: vslam-debugging (validate localization), isaac-ros-performance (verify VSLAM real-time)
- **Chapter 9 Skills**: nav2-humanoid-config (humanoid-specific Nav2 params), behavior-tree-design (navigation + recovery logic)

**Workflow**:
1. **Specification Writing** (FIRST): Students write detailed spec.md defining navigation requirements
2. **Component Integration**:
   - Isaac Sim scene with humanoid + moving obstacles (Chapter 7)
   - Isaac Visual SLAM for localization (Chapter 8)
   - Nav2 for planning/control (Chapter 9)
3. **Iteration Loop**:
   - Run full pipeline (Sim → VSLAM → Nav2)
   - Apply debugging skills to identify failures
   - Tune parameters using humanoid config skill
   - Validate recovery behaviors using BT design skill
4. **Final Validation**: 5-minute autonomous navigation demo (multiple goals, dynamic obstacles)

**Content Elements**:
- **Spec-first requirement**: Students write specification BEFORE integration
- **Full Part 3 integration**: Isaac Sim + VSLAM + Nav2 all working together
- **Skill composition**: How do all 6 skills (from Ch7-9) apply?
- **AI orchestration**: AI integrates components from spec
- **Convergence**: Student validates output, AI refines, iterate until spec satisfied
- **Success validation**: Full autonomous navigation working end-to-end

**Prerequisites**: All lessons from Chapters 7-9

**Estimated Time**: 180 minutes (comprehensive Part 3 capstone)

---

## IV. Skill Dependencies

**Skill Dependency Graph**:
```
Part 1 ROS 2 actions → Lesson 1 (Nav2 actions)
Part 3 Ch7 Isaac Sim → Lesson 1-9 (simulation environment)
Part 3 Ch8 VSLAM → Lesson 9 (localization source)

Lesson 1 (Nav2 architecture) → Lesson 2 (costmaps)
Lesson 2 (costmaps) → Lesson 3 (planners)
Lesson 3 (planners) → Lesson 4 (controllers)
Lesson 4 (controllers) + Lesson 5 (BT) → Lesson 6 (dynamic obstacles)
Lessons 2-6 (Nav2 experience) → Lesson 7 (humanoid-config skill)
Lesson 5 (BT design) → Lesson 8 (behavior-tree-design skill)
Lessons 7-8 (skills) + Ch7-8 skills → Lesson 9 (capstone)
```

**Cross-Chapter Dependencies**:
- Part 1 (ROS 2 actions, lifecycle) → Required for all lessons
- Part 3 Chapter 7 (Isaac Sim) → Required for simulation environment
- Part 3 Chapter 8 (VSLAM) → Required for Lesson 9 localization
- Validation: ✅ Prerequisites implemented

---

## V. Assessment Plan

### Formative Assessments (During Lessons)
- Lesson 2: Costmap visualization (footprint and inflation correct)
- Lesson 3: Path quality (smooth, kinematically feasible)
- Lesson 5: Behavior tree recovery (stuck detection and resolution)
- Lesson 6: Dynamic avoidance (replanning around moving human)

### Summative Assessment (End of Chapter)
- Lesson 9: Capstone navigation evaluation (autonomous, safe, recovers from failures, real-time)

**All assessments align with B2-C1 proficiency + Bloom's Apply/Evaluate/Create levels**

---

## VI. Validation Checklist

**Chapter-Level Validation**:
- [x] Chapter type identified (technical/code-focused)
- [x] Concept density analysis documented (10 concepts → 9 lessons justified)
- [x] Lesson count justified by concept density + B2-C1 tier
- [x] All evals from spec covered by lessons
- [x] All lessons map to at least one eval

**Stage Progression Validation**:
- [x] Lessons 1-2: Layer 1 (Manual architecture + costmaps, no AI)
- [x] Lessons 3-6: Layer 2 (AI Collab with Three Roles)
- [x] Lessons 7-8: Layer 3 (Intelligence Design, reusable skills)
- [x] Lesson 9: Layer 4 (Spec-Driven Integration, full Part 3 capstone)
- [x] No spec-first before Layer 4 (Lesson 2 uses spec for footprint requirements; Lesson 5 uses spec for BT design; both appropriate pre-implementation specification)

**Cognitive Load Validation**:
- [x] B2 lessons (1-3): 7-8 concepts ≤ 10 limit
- [x] C1 lessons (4-9): 7-8 concepts ≤ 12 limit
- [x] Complex Nav2 concepts distributed across lessons

**Dependency Validation**:
- [x] Skill dependencies satisfied by lesson order
- [x] Cross-chapter dependencies validated (Part 1, Part 3 Ch7-8 prerequisites)

**Three Roles Validation** (Layer 2 lessons):
- [x] Lessons 3-6 each demonstrate AI as Teacher
- [x] Lessons 3-6 each demonstrate AI as Student
- [x] Lessons 3-6 each demonstrate AI as Co-Worker (convergence)

**Teaching Modality Validation**:
- [x] Primary: Collaborative parameter tuning (Lessons 3, 4, 6 - student + AI iterate on configs)
- [x] Secondary: Behavior tree design using specification-first (Lesson 5 - spec BEFORE BT XML)
- [x] Distinct from Part 2 (hands-on), Ch7 (hands-on + Socratic), Ch8 (error analysis + spec-first)

---

## VII. Anti-Convergence Notes

**Part 2 Patterns Used**: All hands-on discovery
**Part 3 Chapter 7 Pattern**: Hands-on discovery + Socratic dialogue
**Part 3 Chapter 8 Pattern**: Error analysis + specification-first

**Part 3 Chapter 9 Variation**:
- **Primary**: Collaborative parameter tuning (Lessons 3, 4, 6 - student + AI iterate on Nav2 configs; neither knows optimal parameters initially, collaboration explores parameter space)
- **Secondary**: Behavior tree design using specification-first (Lesson 5 - write BT requirements BEFORE XML implementation)
- **Rationale**: Nav2 parameter tuning has no single "correct" answer (depends on robot, environment, mission). Collaborative exploration with AI is most effective learning strategy. Behavior trees require specification-first approach (define logic BEFORE implementation).

**Result**: Teaching modality distinct from all previous chapters. Chapter 9 uses collaborative tuning + BT design patterns.

---

**End of Chapter 9 Lesson Plan**
